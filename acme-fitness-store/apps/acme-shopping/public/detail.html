<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="robots" content="all,follow">
    <meta name="googlebot" content="index,follow,snippet,archive">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>ACME Fitness</title>
    <meta name="keywords" content="">
    <!-- Bootstrap CSS-->
    <link rel="stylesheet" href="vendor/bootstrap/css/bootstrap.min.css">
    <!-- Google fonts - Montserrat and Merriweather-->
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700|Merriweather:400,400italic" rel="stylesheet" type="text/css">
    <!-- Font Awesome css-->
    <link rel="stylesheet" href="vendor/font-awesome/css/font-awesome.min.css">
    <!-- Owl Carousel-->
    <link rel="stylesheet" href="vendor/owl.carousel/assets/owl.carousel.min.css">
    <link rel="stylesheet" href="vendor/owl.carousel/assets/owl.theme.default.min.css">
    <!-- Theme stylesheet-->
    <link id="theme-stylesheet" href="css/style.default.css" rel="stylesheet">
    <!-- Custom stylesheet - for your changes-->
    <link href="css/custom.css" rel="stylesheet">
    <!-- Tweaks for older IEs--><!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script><![endif]-->
    <!-- Favicon-->
    <link rel="shortcut icon" href="favicon.png">
  </head>
  <body>
    <!-- *** NAVBAR *** -->
    <nav id="navbar" role="navigation" class="navbar navbar-light fixed-top navbar-expand-lg yamm justify-content-between">
    </nav>
    <!-- /#navbar-->
    <!-- *** NAVBAR END ***-->
    <!--  *** LOGIN MODAL ***-->
    <div tabindex="-1" role="dialog" class="modal">
      <div role="document" class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Modal title</h5>
            <button type="button" data-dismiss="modal" aria-label="Close" class="close"><span aria-hidden="true">Ã—</span></button>
          </div>
          <div class="modal-body">
            <p>Modal body text goes here.</p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-primary">Save changes</button>
            <button type="button" data-dismiss="modal" class="btn btn-secondary">Close</button>
          </div>
        </div>
      </div>
    </div>
    <div id="login-modal" tabindex="-1" role="dialog" aria-labelledby="Login" aria-hidden="true" class="modal fade">
    </div>
    <!-- *** LOGIN MODAL END ***-->
    <div id="all">
      <div id="content">
        <div class="container">
          <ul class="breadcrumb justify-content-md-end justify-content-center">
            <li class="breadcrumb-item"><a href="index.html">Home</a></li>
            <li id="productName" class="breadcrumb-item active"></li>
          </ul>
          <div class="box text-center">
            <div class="row">
              <div class="col-md-10 offset-md-1">
                <h1 id="productTitle"></h1>
                <p class="text-muted" id="descriptionTitle">
                </p>
                <p class="goToDescription"><a href="#details" class="scroll-to">Scroll to product details</a></p>
              </div>
            </div>
          </div>
          <div class="row">
            <!-- *** LEFT COLUMN ***-->
            <div class="col-lg-9">
              <div id="productMain" class="row">
                <div class="col-md-6">
                  <div id="mainImage"></div>
                  <div class="ribbon sale">
                    <div class="theribbon">SALE</div>
                    <div class="ribbon-background"></div>
                  </div>
                  <!-- /.ribbon-->
                  <div class="ribbon new">
                    <div class="theribbon">NEW</div>
                    <div class="ribbon-background"></div>
                  </div>
                  <!-- /.ribbon-->
                </div>
                <div class="col-md-6">
                  <div class="box">
                    <form>
                      <div class="sizes">
                        <h3>Available Now</h3>
                      </div>
                      <p id="productPrice" class="price"></p>
                      <p class="text-center">
                        <button id="addToCart" type="submit" class="btn btn-primary"><i class="fa fa-shopping-cart"></i> Add to cart</button>
                        <button type="submit" data-toggle="tooltip" data-placement="top" title="Add to wishlist" class="btn btn-outline-secondary"><i class="fa fa-heart-o"></i></button>
                      </p>
                    </form>
                  </div>
                  <div id="thumbs" class="row">
                    <!-- <div class="col-4"><a href="img/bottle.jpg" class="thumb"><img  src="img/detailsquare.jpg" alt="" class="img-fluid"></a></div>
                    <div class="col-4"><a href="img/bottle.jpg" class="thumb"><img id="thumbImg2" src="img/detailsquare2.jpg" alt="" class="img-fluid"></a></div> -->
                  </div>
                </div>
              </div>
              <div id="details" class="box">
                <p></p>
                <h4>Product details</h4>
                <p id="detailedDescription"></p>
                <blockquote>
                  <p><em>
                      Stay Fit with ACME Fitness</em></p>
                </blockquote>
              </div>
              <div id="product-social" class="box social">
                <h4>Show it to your friends</h4>
                <p><a href="#" data-animate-hover="pulse" class="external facebook"><i class="fa fa-facebook"></i></a><a href="#" data-animate-hover="pulse" class="external twitter"><i class="fa fa-twitter"></i></a><a href="#" data-animate-hover="pulse" class="email"><i class="fa fa-envelope"></i></a></p>
              </div>

            </div>
          </div>
        </div>
      </div>
      <!-- *** FOOTER ***-->
      <div id="footer">
      </div>
      <!-- /#footer-->
      <!-- *** FOOTER END ***-->
    </div>
    <!-- #### JavaScript files ###-->
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/popper.js/umd/popper.min.js"> </script>
    <script src="vendor/bootstrap/js/bootstrap.min.js"></script>
    <script src="vendor/jquery.cookie/jquery.cookie.js"> </script>
    <script src="vendor/owl.carousel/owl.carousel.min.js"></script>
    <!-- main script-->
    <script src="js/front.js"> </script>
    <script src="js/client.js"></script>
    <script src="js/jwt-decode.min.js"></script>
    <script>
      $(document).ready(function() {
          $.ajaxSetup({
              contentType: "application/json; charset=utf-8"
          });

          $("#navbar").load('navbar.html')
          $("#login-modal").load("login.html")
          $("#footer").load('footer.html')

          var productid = window.location.search.split('?id=')[1]
          console.log('productid: ' + productid)

          if (productid== null || productid == "") {
                document.location.href = "/";
          }

          $.ajax({
              url: "/products/" + productid,
              type: "GET",
              success: function(body, textStatus, jqXHR) {

                console.log('received product detail: ' + body)
                // Set all the field dynamically
                if(body != null) {
                    let dollarUSLocale = Intl.NumberFormat('en-US');
                    $("#productName").html(body.data.name)
                    $("#productTitle").html(body.data.name)
                    $("#descriptionTitle").html(body.data.shortDescription)
                    $("#productPrice").html(dollarUSLocale.format(body.data.price))
                    $("#detailedDescription").html(body.data.description)
                    var img = '<img src="' + body.data.imageUrl2 +'" alt="" class="img-fluid">'
                    $("#mainImage").html(img);
                    var thumbImg = '<div class="col-4"><a href="'+ body.data.imageUrl1 +'" class="thumb"><img  src="'+ body.data.imageUrl1 +'" alt="" class="img-fluid"></a></div>\
                                    <div class="col-4"><a href="'+ body.data.imageUrl3 +'" class="thumb"><img  src="'+ body.data.imageUrl3 +'" alt="" class="img-fluid"></a></div>\
                                    <div class="col-4"><a href="'+ body.data.imageUrl2 +'" class="thumb"><img  src="'+ body.data.imageUrl2 +'" alt="" class="img-fluid"></a></div>'
                    $("#thumbs").html(thumbImg)
                }
              },
              error: function(jqXHR, textStatus, errorThrown) {
                console.log(errorThrown)
              }
          });

          $("#addToCart").click(function(e) {
               e.preventDefault();

                var vals = {
                  "name": $("#productName").html(),
                  "price": $('#productPrice').html(),
                  "shortDescription": $('#descriptionTitle').html(),
                  "quantity": 1,
                  "itemid": productid
                }

                console.log('data for cart ', vals)

                var userid = getUserID();

                $.ajax({
                  url: "/cart/item/add/" + userid,
                  type: "POST",
                  data: JSON.stringify(vals),
                  success: function(data, textStatus, jqXHR) {

                    console.log('received product detail: ' + data)

                    if(jqXHR.status == 200) {
                      // Set all the field dynamically
                      if(data != null) {
                        location.reload();
                      }
                    }
                    else {
                      console.log('Data could not be retrievd ' + jqXHR.status)
                    }
                  },
                  error: function(jqXHR, textStatus, errorThrown) {
                    console.log('Could not add item due to : ' + textStatus + ' | ' + errorThrown)
                    window.location.href = "/Unauthorized.html"
                  }
                });
           });
        }); // End of Document Ready

    </script>
  </body>
</html>